use criterion::{black_box, criterion_group, criterion_main, Criterion};
use treetime::representation::seq::Seq;
use treetime::representation::seq_char::AsciiChar;
use treetime::seq::find_char_ranges::find_letter_ranges_by;

const SEQ: &str = "\
  TATCATTATTGGTGGAGCTAAACTTAAAGCCTTGAATTTAGGTGAAACATTTGTCACGCA\
  CTCAAANNNNNNNNNNNNNAAGTGTGTTAAATCCAGAGAAGAAACTGGCCTACTCATGCC\
  TCTAAAAGCCCCAAAAGAAATTATCTTCTTAGAGGGAGAAACACTTCCCACAGAAGTGTT\
  AACAGAGGAAGTTGTCTTGAAAACTGGTGATTTACAACCATTAGAACAACCTACTAGTGA\
  AGCTGTTGAAGCTCCATTGGTTGGTACACCAGTTTGTATTAACGGGCTTATGTTGCTCGA\
  AATCAAAGACACAGAN-------------TTGCACCTAATATGATGGTAACAAACAATAC\
  CTTCACACTCAAAGGCGGTGCACCAACAAAGGTTACTTTTGGTGATGACACTGTGATAGA\
  AGTGCAAGGTTACAAGAGTGTGAATATCACTTTTGAACTTGATGAAAGGATTGATAAAGT\
  ACTTAATGAGAAGTGCTCTGCCTATACAGTTGAACTCGGTACAGAAGTAAATGAGTTCGC\
  CTGTGTTGTGGCAGATGCTGTCATAAAAACTTTGCAACCAGTATCTGAATTACTTACACC\
  ACTGGGCATTGATTTAGATGAGTGGAGTATGGCTACATACTACTTATTTGATGAGTCTGG\
  TGAGTTTAAATTGGCTTCACATATGTATTGTTCTTTCTACCCTCCAGATGAGGATGAAGA\
  AGAAGGTGATTGTGAAGAANNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNCTGA\
  AGATGATTACCAAGGTAAACCTTTGGAATTTGGTGCCACTTCTGCTGCTCTTCAACCTGA\
  AGAAGAGCAAGAAGAAGATTGGTTAGATGATGATAGTCAACAAACTGTTGGTCAACAAGA\
  CGGCAGTGAGGACAATCAGACAACTACTATTCAAACAATTGTTGAGGTTCAACCTCAATT\
  AGAGATGGAACTTACACCAGTTGTTCAGACTATTGAAGTGAATAGTTTTAGTGGTTATTT\
  AAAACTTACTGACAATGTATACATTAAAA-----------GTGGAAGAAGCTAAAAAGGT\
  AAAACCAACAGTGGTTGTTAATGCAGCCAATGTTTACCTTAAACATGGAGGAGGTGTTGC\
  AGGAGCCTTAAATAAGGCTACTAACAATGCCATGCAAGTTGAATCTGATGATTACATAGC\
  TACTAAT------------NNNNNNNNNNGTTGTGTTTTAAGCGGACACAATCTTGCTAA\
  ACACTGTCTTCATGTTGTCGGCCCAAATGTTAACAAAGGTGAAGACATTCAACTTCTTAA\
";

fn pred(c: AsciiChar) -> bool {
  c == AsciiChar(b'N') || c == AsciiChar(b'-')
}

pub fn bench_1(c: &mut Criterion) {
  let seq: Seq = SEQ.into();
  c.bench_function("find_letter_ranges_by", |b| {
    b.iter(|| find_letter_ranges_by(black_box(&seq), pred));
  });
}

// pub fn bench_2(c: &mut Criterion) {
//   let seq: Seq = SEQ.into();
//   c.bench_function("find_letter_ranges_by_old", |b| {
//     b.iter(|| find_letter_ranges_by_old(black_box(&seq), pred));
//   });
// }

criterion_group!(find_letter_ranges, bench_1);
criterion_main!(find_letter_ranges);
